<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time Data Anomaly Detection API | DataGems EOSC Project</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #f6f8fa;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .nav {
            background: white;
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .nav ul {
            list-style: none;
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .nav a {
            color: #0366d6;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav a:hover {
            color: #0256c7;
            text-decoration: underline;
        }

        .section {
            background: white;
            margin: 2rem 0;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #0366d6;
            font-size: 1.8rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e1e4e8;
        }

        .section h3 {
            color: #24292e;
            font-size: 1.3rem;
            margin: 1.5rem 0 1rem 0;
        }

        .param-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1rem 0;
        }

        .param-card {
            background: #f6f8fa;
            padding: 1.5rem;
            border-radius: 6px;
            border-left: 4px solid #0366d6;
        }

        .param-card h4 {
            color: #0366d6;
            margin-bottom: 0.5rem;
        }

        .param-card .type {
            color: #6f42c1;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .param-card .desc {
            color: #586069;
            margin-top: 0.5rem;
        }

        .code-block {
            background: #f6f8fa;
            border: 1px solid #d1d5da;
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .code-block pre {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #24292e;
        }

        .highlight {
            background: #fffbdd;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .badge-primary {
            background: #0366d6;
            color: white;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-info {
            background: #17a2b8;
            color: white;
        }

        .badge-warning {
            background: #ffc107;
            color: #212529;
        }

        .method-card {
            background: linear-gradient(to right, #f6f8fa 0%, white 10%);
            border-left: 4px solid #28a745;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 6px;
        }

        .example-section {
            background: #f6f8fa;
            padding: 1.5rem;
            border-radius: 6px;
            margin: 1rem 0;
        }

        .workflow-diagram {
            background: white;
            border: 2px dashed #d1d5da;
            padding: 2rem;
            border-radius: 6px;
            text-align: center;
            margin: 1.5rem 0;
        }

        .workflow-step {
            display: inline-block;
            background: #0366d6;
            color: white;
            padding: 1rem 1.5rem;
            margin: 0.5rem;
            border-radius: 6px;
            font-weight: 600;
        }

        .workflow-arrow {
            display: inline-block;
            color: #0366d6;
            font-size: 1.5rem;
            margin: 0 0.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        table th {
            background: #f6f8fa;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            border: 1px solid #d1d5da;
        }

        table td {
            padding: 0.75rem;
            border: 1px solid #d1d5da;
        }

        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .info-box-icon {
            color: #0c5460;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .footer {
            background: #24292e;
            color: #ffffff;
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .nav ul {
                flex-direction: column;
                gap: 0.5rem;
            }

            .param-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>üåê Real-Time Data Anomaly Detection API</h1>
            <p>Weather Time Series Anomaly Detection Service | DataGems EOSC Project</p>
        </div>
    </div>

    <nav class="nav">
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#quickstart">Quick Start</a></li>
            <li><a href="#api-methods">API Methods</a></li>
            <li><a href="#input-output">Input/Output</a></li>
            <li><a href="#workflow">Workflow</a></li>
            <li><a href="#examples">Examples</a></li>
            <li><a href="#faq">FAQ</a></li>
        </ul>
    </nav>

    <div class="container">
        <!-- Overview -->
        <section id="overview" class="section">
            <h2>üìã Overview</h2>
            
            <div class="info-box">
                <span class="info-box-icon">‚ÑπÔ∏è</span>
                <strong>Description:</strong> A real-time anomaly detection API service for weather station time series data using sliding window technique. The system connects to a complete historical database (Full Data), uses a pointer to locate user-specified starting timestamp, extracts a Data Stream from that point to current time, and applies sliding windows for anomaly detection.
            </div>
            
            <h3>System Architecture</h3>
            <div class="workflow-diagram">
                <div class="workflow-step">Full Data<br><small>[0 ‚Üí current]</small></div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">Pointer<br><small>[user: 47]</small></div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">Data Stream<br><small>[47 ‚Üí current]</small></div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">Sliding Windows<br><small>[W, S]</small></div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">Detect<br><small>[Z-score]</small></div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">Results</div>
            </div>
            <p style="text-align: center; color: #586069; margin-top: 1rem;">
                <strong>Full Data:</strong> Complete historical database (e.g., timestamps 0 ‚Üí 10000)<br>
                <strong>Pointer:</strong> User inputs starting timestamp (e.g., 47) ‚Üí Locates position in Full Data<br>
                <strong>Data Stream:</strong> Extracted subset from pointer to current (e.g., 47 ‚Üí 10000)<br>
                <strong>Sliding Windows:</strong> Split Data Stream into overlapping windows for analysis<br>
                <strong>Output:</strong> Anomaly list for each window
            </p>

            <h3>Key Features</h3>
            <div class="param-grid">
                <div class="param-card">
                    <h4>üïê Sliding Window</h4>
                    <p class="desc">Window Length: W time points<br>Stride: S time points</p>
                </div>
                <div class="param-card">
                    <h4>üìä 5 Core Variables</h4>
                    <p class="desc">Temperature, Humidity, Wind Speed, Pressure, Rainfall</p>
                </div>
                <div class="param-card">
                    <h4>‚ö° Real-Time Processing</h4>
                    <p class="desc">Supports streaming data input with automatic anomaly detection</p>
                </div>
                <div class="param-card">
                    <h4>üìç Multi-Station Support</h4>
                    <p class="desc">Simultaneous monitoring of multiple weather stations</p>
                </div>
            </div>

            <h3>Technical Parameters</h3>
            <table>
                <tr>
                    <th>Parameter</th>
                    <th>Symbol</th>
                    <th>Default Value</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><span class="highlight">window_len</span></td>
                    <td>W</td>
                    <td>60</td>
                    <td>Sliding window length (number of time points)</td>
                </tr>
                <tr>
                    <td><span class="highlight">stride</span></td>
                    <td>S</td>
                    <td>18</td>
                    <td>Sliding stride (number of time points)</td>
                </tr>
                <tr>
                    <td><span class="highlight">time_interval</span></td>
                    <td>Œît</td>
                    <td>10 min</td>
                    <td>Interval between consecutive time points</td>
                </tr>
                <tr>
                    <td><span class="highlight">detection_frequency</span></td>
                    <td>-</td>
                    <td>S √ó Œît</td>
                    <td>Detection frequency after each slide</td>
                </tr>
                <tr>
                    <td><span class="highlight">algorithm</span></td>
                    <td>-</td>
                    <td>zscore</td>
                    <td>Anomaly detection algorithm</td>
                </tr>
                <tr>
                    <td><span class="highlight">threshold</span></td>
                    <td>œÉ/k</td>
                    <td>2.5</td>
                    <td>Algorithm-specific threshold</td>
                </tr>
            </table>

            <h3>Supported Algorithms</h3>
            <div class="param-grid">
                <div class="param-card">
                    <h4>üìä Z-Score (Default)</h4>
                    <p class="type">algorithm: "zscore"</p>
                    <p class="desc"><strong>Formula:</strong> Z = (X - Œº) / œÉ</p>
                    <p class="desc"><strong>Threshold:</strong> 2.5 - 3.0</p>
                    <p class="desc"><strong>Best for:</strong> Normally distributed data</p>
                    <p class="desc">‚úÖ Fast, interpretable<br>‚ùå Sensitive to outliers</p>
                </div>
                <div class="param-card">
                    <h4>üì¶ IQR (Interquartile Range)</h4>
                    <p class="type">algorithm: "iqr"</p>
                    <p class="desc"><strong>Formula:</strong> IQR = Q3 - Q1</p>
                    <p class="desc"><strong>Threshold:</strong> 1.5 - 3.0</p>
                    <p class="desc"><strong>Best for:</strong> Skewed distributions</p>
                    <p class="desc">‚úÖ Robust to outliers<br>‚ùå Less sensitive</p>
                </div>
                <div class="param-card">
                    <h4>üéØ MAD (Median Absolute Deviation)</h4>
                    <p class="type">algorithm: "mad"</p>
                    <p class="desc"><strong>Formula:</strong> MAD = median(|X - median(X)|)</p>
                    <p class="desc"><strong>Threshold:</strong> 3.0 - 4.0</p>
                    <p class="desc"><strong>Best for:</strong> Noisy data</p>
                    <p class="desc">‚úÖ Very robust<br>‚ùå Slower computation</p>
                </div>
                <div class="param-card">
                    <h4>üå≤ Isolation Forest</h4>
                    <p class="type">algorithm: "isolation_forest"</p>
                    <p class="desc"><strong>Type:</strong> Machine Learning</p>
                    <p class="desc"><strong>Threshold:</strong> 5 - 20 (contamination rate)</p>
                    <p class="desc"><strong>Best for:</strong> Complex patterns</p>
                    <p class="desc">‚úÖ High-dimensional data<br>‚ùå Black box model</p>
                </div>
            </div>
        </section>

        <!-- Quick Start -->
        <section id="quickstart" class="section">
            <h2>üöÄ Quick Start</h2>
            
            <div class="example-section">
                <h3>1. Prepare Your Request</h3>
                <p>You only need to specify a <strong>starting timestamp</strong> and optional parameters. The system will automatically connect to the full data source and stream data forward.</p>
            </div>

            <div class="example-section">
                <h3>2. Send API Request</h3>
                <div class="code-block">
                    <pre>import requests

url = "https://real-time-data-profiler.onrender.com/detect"

# User inputs starting timestamp
data = {
    "start_timestamp": 1729584600,  # Pointer to data stream
    "window_len": 60,                # W = 60 time points (10 hours)
    "stride": 18,                    # S = 18 time points (3 hours)
    "threshold": 2.5,                # Threshold for anomaly detection
    "algorithm": "zscore"            # Detection algorithm
}

response = requests.post(url, json=data)
result = response.json()</pre>
                </div>
            </div>

            <div class="example-section">
                <h3>3. View Results</h3>
                <div class="code-block">
                    <pre># Check detection results
if result["status"] == "anomalies_found":
    print(f"Found {result['total_anomalies']} anomalies in {result['total_windows']} windows")
    
    for window in result["windows"]:
        print(f"\nWindow [{window['window_start']} ‚Üí {window['window_end']}]:")
        for anomaly in window["anomalies"]:
            print(f"  Station {anomaly['station_id']}: {anomaly['variable']} = {anomaly['anomaly_value']}")
else:
    print("No anomalies detected")</pre>
                </div>
            </div>
        </section>

        <!-- API Methods -->
        <section id="api-methods" class="section">
            <h2>üîß API Endpoint</h2>

            <!-- POST /detect -->
            <div class="method-card">
                <h3><span class="badge badge-primary">POST</span> /detect</h3>
                <p><strong>Function:</strong> Detect anomalies in weather data stream starting from a specified timestamp</p>
                
                <h4>Request Parameters:</h4>
                <table>
                    <tr>
                        <th>Parameter</th>
                        <th>Type</th>
                        <th>Symbol</th>
                        <th>Default</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="highlight">start_timestamp</span></td>
                        <td>int</td>
                        <td>t‚ÇÄ</td>
                        <td><strong>Required</strong></td>
                        <td>Starting timestamp (Unix format) - Pointer to data stream</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">window_len</span></td>
                        <td>int</td>
                        <td>W</td>
                        <td>60</td>
                        <td>Sliding window length (number of time points)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">stride</span></td>
                        <td>int</td>
                        <td>S</td>
                        <td>18</td>
                        <td>Sliding stride (number of time points)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">threshold</span></td>
                        <td>float</td>
                        <td>œÉ/k</td>
                        <td>2.5</td>
                        <td>Threshold for anomaly detection (interpretation depends on algorithm)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">algorithm</span></td>
                        <td>string</td>
                        <td>-</td>
                        <td>"zscore"</td>
                        <td>Detection algorithm: <code>zscore</code>, <code>iqr</code>, <code>mad</code>, <code>isolation_forest</code></td>
                    </tr>
                </table>

                <h4>Request Example:</h4>
                <div class="code-block">
                    <pre>POST https://real-time-data-profiler.onrender.com/detect

{
  "start_timestamp": 1729584600,
  "window_len": 60,
  "stride": 18,
  "threshold": 2.5,
  "algorithm": "zscore"
}</pre>
                </div>

                <h4>Response Structure:</h4>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="highlight">status</span></td>
                        <td>string</td>
                        <td>"anomalies_found" or "no_anomalies"</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">total_windows</span></td>
                        <td>int</td>
                        <td>Number of sliding windows analyzed</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">total_anomalies</span></td>
                        <td>int</td>
                        <td>Total number of anomalies detected</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">windows</span></td>
                        <td>List[Window]</td>
                        <td>List of windows with anomalies</td>
                    </tr>
                </table>

                <h4>Window Object Structure:</h4>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="highlight">window_id</span></td>
                        <td>int</td>
                        <td>Sequential window identifier</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">window_start</span></td>
                        <td>string</td>
                        <td>Window start time (YYYY-MM-DD HH:MM:SS)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">window_end</span></td>
                        <td>string</td>
                        <td>Window end time (YYYY-MM-DD HH:MM:SS)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">anomalies</span></td>
                        <td>List[Anomaly]</td>
                        <td>List of anomalies in this window</td>
                    </tr>
                </table>

                <h4>Anomaly Object Structure:</h4>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><span class="highlight">station_id</span></td>
                        <td>string</td>
                        <td>Weather station ID (location)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">variable</span></td>
                        <td>string</td>
                        <td>Anomalous variable (temp_out, out_hum, wind_speed, bar, rain)</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">anomaly_value</span></td>
                        <td>float</td>
                        <td>The anomalous value</td>
                    </tr>
                    <tr>
                        <td><span class="highlight">anomaly_timestamp</span></td>
                        <td>string</td>
                        <td>Exact time of anomaly occurrence</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- Input/Output -->
        <section id="input-output" class="section">
            <h2>üì•üì§ Input/Output Format</h2>

            <h3>Input Format</h3>
            <div class="example-section">
                <h4>Request Body:</h4>
                <div class="code-block">
                    <pre>{
    "start_timestamp": 1729584600,  // Starting point in data stream (Unix timestamp)
    "window_len": 60,               // W = Window length in time points
    "stride": 18,                   // S = Sliding stride in time points
    "threshold": 2.5,               // Threshold for anomaly detection
    "algorithm": "zscore"           // Detection algorithm (zscore, iqr, mad, isolation_forest)
}</pre>
                </div>
                <p><strong>Note:</strong> You only need to provide the starting timestamp. The system will:</p>
                <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                    <li>Connect to <strong>Full Data</strong> (complete historical database, e.g., 0 ‚Üí 10000)</li>
                    <li>Use <strong>Pointer</strong> to locate your timestamp (e.g., 47)</li>
                    <li>Extract <strong>Data Stream</strong> from pointer to current time (e.g., 47 ‚Üí 10000)</li>
                    <li>Apply <strong>Sliding Windows</strong> to Data Stream for all stations and all 5 variables</li>
                </ul>
            </div>

            <h3>Output Format</h3>
            <div class="example-section">
                <h4>Response Structure:</h4>
                <div class="code-block">
                    <pre>{
    "status": "anomalies_found",
    "message": "Detected 3 anomaly(ies) across 2 window(s)",
    "total_windows": 2,
    "total_anomalies": 3,
    "windows": [
        {
            "window_id": 1,
            "window_start": "2024-10-22 08:00:00",
            "window_end": "2024-10-22 18:00:00",
            "anomalies": [
                {
                    "station_id": "574",
                    "variable": "temp_out",
                    "anomaly_value": 35.5,
                    "anomaly_timestamp": "2024-10-22 12:30:00"
                },
                {
                    "station_id": "575",
                    "variable": "wind_speed",
                    "anomaly_value": 42.3,
                    "anomaly_timestamp": "2024-10-22 14:20:00"
                }
            ]
        },
        {
            "window_id": 2,
            "window_start": "2024-10-22 11:00:00",
            "window_end": "2024-10-22 21:00:00",
            "anomalies": [
                {
                    "station_id": "576",
                    "variable": "bar",
                    "anomaly_value": 995.2,
                    "anomaly_timestamp": "2024-10-22 15:40:00"
                }
            ]
        }
    ],
    "detection_params": {
        "start_timestamp": 1729584600,
        "window_len": 60,
        "stride": 18,
        "threshold": 2.5
    }
}</pre>
                </div>
            </div>

            <h3>Output Explanation</h3>
            <div class="param-grid">
                <div class="param-card">
                    <h4>üìä Window Level</h4>
                    <p class="desc">Each window represents one sliding window analysis</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>window_id:</strong> Sequential identifier</li>
                        <li><strong>window_start/end:</strong> Time range analyzed</li>
                        <li><strong>anomalies:</strong> All anomalies found in this window</li>
                    </ul>
                </div>
                <div class="param-card">
                    <h4>üö® Anomaly Level</h4>
                    <p class="desc">Each anomaly is a (station, timestamp, variable) tuple</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>station_id:</strong> Where (location)</li>
                        <li><strong>variable:</strong> What variable</li>
                        <li><strong>anomaly_value:</strong> The anomalous value</li>
                        <li><strong>anomaly_timestamp:</strong> When it occurred</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Workflow -->
        <section id="workflow" class="section">
            <h2>üîÑ Data Stream Workflow</h2>

            <div class="workflow-diagram">
                <div class="workflow-step">1. User Input</div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">2. Connect to Full Data</div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">3. Stream Data</div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">4. Sliding Windows</div>
                <div class="workflow-arrow">‚Üí</div>
                <div class="workflow-step">5. Detect & Return</div>
            </div>

            <h3>Detailed Steps</h3>
            
            <div class="param-grid">
                <div class="param-card">
                    <h4>Step 1: User Provides Timestamp</h4>
                    <p class="desc">User sends a starting timestamp (t‚ÇÄ) and parameters (W, S, œÉ, algorithm)</p>
                    <div class="code-block">
                        <pre>POST /detect
{
  "start_timestamp": 1729584600,
  "window_len": 60,
  "stride": 18,
  "threshold": 2.5,
  "algorithm": "zscore"
}</pre>
                    </div>
                </div>

                <div class="param-card">
                    <h4>Step 2: Connect to Full Data</h4>
                    <p class="desc">System connects to the complete historical database:</p>
                    <div class="code-block">
                        <pre>Full Data = [0, 1, 2, ..., 10000]
All timestamps (e.g., 0 ‚Üí 10000)
All station locations
All 5 variables (temp_out, out_hum, wind_speed, bar, rain)</pre>
                    </div>
                </div>

                <div class="param-card">
                    <h4>Step 3: Extract Data Stream</h4>
                    <p class="desc">Pointer locates user timestamp (e.g., 47), extract Data Stream from 47 to current (10000):</p>
                    <div class="code-block">
                        <pre>Pointer = 47
Data Stream = [47, 48, 49, ..., 10000]
(Subset of Full Data)

For ALL stations
For ALL 5 variables</pre>
                    </div>
                </div>

                <div class="param-card">
                    <h4>Step 4: Apply Sliding Windows</h4>
                    <p class="desc">Split Data Stream into overlapping windows (W=60, S=18):</p>
                    <div class="code-block">
                        <pre>Window 1: [47, ..., 47+60] = [47, 107]
Window 2: [47+18, ..., 47+18+60] = [65, 125]
Window 3: [47+36, ..., 47+36+60] = [83, 143]
...
Until reaching current time (10000)</pre>
                    </div>
                </div>

                <div class="param-card">
                    <h4>Step 5: Detect in Each Window</h4>
                    <p class="desc">For each window, apply selected algorithm:</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>zscore:</strong> Z = (X - Œº) / œÉ</li>
                        <li><strong>iqr:</strong> Bounds = Q1 - k√óIQR, Q3 + k√óIQR</li>
                        <li><strong>mad:</strong> Modified Z = 0.6745√ó(X - median) / MAD</li>
                        <li><strong>isolation_forest:</strong> ML-based isolation</li>
                    </ul>
                    <p class="desc" style="margin-top: 0.5rem;">Flag values exceeding threshold</p>
                </div>

                <div class="param-card">
                    <h4>Step 6: Return Results</h4>
                    <p class="desc">Return all anomalies grouped by window:</p>
                    <div class="code-block">
                        <pre>{
  "windows": [
    {
      "window_id": 1,
      "anomalies": [...]
    },
    ...
  ]
}</pre>
                    </div>
                </div>
            </div>

            <h3>Visual Example</h3>
            <div class="info-box">
                <strong>Scenario:</strong><br>
                ‚Ä¢ <strong>Full Data:</strong> Timestamps 0 ‚Üí 10000 (complete historical database)<br>
                ‚Ä¢ <strong>User Input:</strong> start_timestamp = 47<br>
                ‚Ä¢ <strong>Pointer:</strong> Locates position 47 in Full Data<br>
                ‚Ä¢ <strong>Data Stream:</strong> Extracted [47 ‚Üí 10000]<br>
                ‚Ä¢ <strong>Parameters:</strong> W=60, S=18, Œît=10min<br><br>
                
                <strong>Sliding Windows Applied to Data Stream:</strong><br>
                <strong>Window 1:</strong> [47 ‚Üí 107] (60 points √ó 10min = 10 hours)<br>
                <strong>Window 2:</strong> [65 ‚Üí 125] (slide by 18 points = 3 hours)<br>
                <strong>Window 3:</strong> [83 ‚Üí 143] (slide by 18 points = 3 hours)<br>
                <strong>...</strong><br>
                <strong>Window N:</strong> [...‚Üí 10000] (until reaching current time)<br><br>
                
                <strong>Overlap:</strong> 50% between consecutive windows (W-S)/W = (60-18)/60 = 70%
            </div>
        </section>

        <!-- Examples -->
        <section id="examples" class="section">
            <h2>üíª Complete Examples</h2>

            <h3>Example 1: Basic Usage</h3>
            <div class="code-block">
                <pre>import requests

# API endpoint
url = "https://real-time-data-profiler.onrender.com/detect"

# Prepare request (user only provides starting timestamp)
data = {
    "start_timestamp": 1729584600,  # October 22, 2024, 08:00:00 UTC
    "window_len": 60,                # 60 points √ó 10min = 10 hours
    "stride": 18,                    # 18 points = 3 hours
    "threshold": 2.5                 # 2.5 standard deviations
}

# Send request
response = requests.post(url, json=data)
result = response.json()

# Process results
if result["status"] == "anomalies_found":
    print(f"‚úÖ Found {result['total_anomalies']} anomalies in {result['total_windows']} windows")
    
    for window in result["windows"]:
        print(f"\nüîç Window {window['window_id']}: [{window['window_start']} ‚Üí {window['window_end']}]")
        for anomaly in window["anomalies"]:
            print(f"   üö® Station {anomaly['station_id']}: {anomaly['variable']} = {anomaly['anomaly_value']}")
            print(f"      Time: {anomaly['anomaly_timestamp']}")
else:
    print("‚úÖ No anomalies detected")</pre>
            </div>

            <h3>Example 2: Different Algorithms</h3>
            <div class="code-block">
                <pre>import requests
from datetime import datetime

url = "https://real-time-data-profiler.onrender.com/detect"

start_time = int(datetime(2024, 10, 22, 8, 0, 0).timestamp())

# Example 1: Z-Score (default, fast, for normal distributions)
response1 = requests.post(url, json={
    "start_timestamp": start_time,
    "window_len": 60,
    "stride": 18,
    "threshold": 2.5,
    "algorithm": "zscore"
})

# Example 2: IQR (robust to outliers, for skewed data)
response2 = requests.post(url, json={
    "start_timestamp": start_time,
    "window_len": 60,
    "stride": 18,
    "threshold": 1.5,
    "algorithm": "iqr"
})

# Example 3: MAD (very robust, for noisy data)
response3 = requests.post(url, json={
    "start_timestamp": start_time,
    "window_len": 60,
    "stride": 18,
    "threshold": 3.5,
    "algorithm": "mad"
})

# Example 4: Isolation Forest (ML-based, for complex patterns)
response4 = requests.post(url, json={
    "start_timestamp": start_time,
    "window_len": 60,
    "stride": 18,
    "threshold": 10,  # 10% contamination
    "algorithm": "isolation_forest"
})

print(f"Z-Score: {response1.json()['total_anomalies']} anomalies")
print(f"IQR: {response2.json()['total_anomalies']} anomalies")
print(f"MAD: {response3.json()['total_anomalies']} anomalies")
print(f"Isolation Forest: {response4.json()['total_anomalies']} anomalies")</pre>
            </div>

            <h3>Example 3: Save Results to File</h3>
            <div class="code-block">
                <pre>import requests
import json
from datetime import datetime

url = "https://real-time-data-profiler.onrender.com/detect"

# Detect anomalies
data = {
    "start_timestamp": 1729584600,
    "window_len": 60,
    "stride": 18,
    "threshold": 2.5
}

response = requests.post(url, json=data)
result = response.json()

# Save to JSON file
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
filename = f"anomaly_report_{timestamp}.json"

with open(filename, "w") as f:
    json.dump(result, f, indent=2)

print(f"Report saved to: {filename}")

# Generate summary report
if result["status"] == "anomalies_found":
    summary = f"""
    Anomaly Detection Summary
    =========================
    Analysis Time: {datetime.now()}
    Total Windows Analyzed: {result['total_windows']}
    Total Anomalies Found: {result['total_anomalies']}
    
    Affected Stations:
    """
    
    stations = set()
    for window in result["windows"]:
        for anomaly in window["anomalies"]:
            stations.add(anomaly["station_id"])
    
    summary += "\n".join([f"  - Station {s}" for s in sorted(stations)])
    
    with open(f"anomaly_summary_{timestamp}.txt", "w") as f:
        f.write(summary)
    
    print(summary)</pre>
            </div>
        </section>

        <!-- FAQ -->
        <section id="faq" class="section">
            <h2>‚ùì Frequently Asked Questions</h2>

            <h3>1. Recommended Window Length Configuration</h3>
            <p>For default configuration, W = 36 time points with Œît = 10 minutes results in a 6-hour window (W √ó Œît = 6 hours). This window length is sufficient to capture short-term variation patterns in meteorological data while avoiding excessive detection delays.</p>

            <h3>2. Recommended Stride Configuration</h3>
            <p>For default configuration, S = 18 time points corresponds to a 3-hour interval (S √ó Œît = 3 hours), meaning detection is performed every 3 hours. This ensures 50% overlap between consecutive windows (S/W = 0.5), improving the continuity of anomaly detection.</p>

            <h3>3. How is a value determined to be anomalous?</h3>
            <p>The system uses statistical methods (Z-score) for determination. If a value deviates from the time series mean by more than 2.5 standard deviations (|Z| > 2.5), it will be flagged as anomalous.</p>

            <h3>4. What variables are supported?</h3>
            <p>The system currently supports 5 core meteorological variables:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li><strong>temp_out</strong>: Outdoor temperature (¬∞C)</li>
                <li><strong>out_hum</strong>: Outdoor humidity (%)</li>
                <li><strong>wind_speed</strong>: Wind speed (m/s)</li>
                <li><strong>bar</strong>: Barometric pressure (hPa)</li>
                <li><strong>rain</strong>: Rainfall (mm)</li>
            </ul>

            <h3>5. How does the system handle missing data?</h3>
            <p>The system automatically skips missing or invalid data points. However, it is recommended to ensure data completeness as much as possible to achieve more accurate detection results.</p>
        </section>
    </div>

    <footer class="footer">
        <p><strong>Real-Time Data Anomaly Detection API v1.0</strong></p>
        <p>DataGems EOSC Project | Weather Anomaly Detection System</p>
        <p style="margin-top: 1rem; opacity: 0.8;">¬© 2025 | Documentation Generated: 2025-10-22</p>
    </footer>
</body>
</html>
